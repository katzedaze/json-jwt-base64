# browser-verify

Engineer's Web Toolbox の全機能をヘッドレスブラウザで自動検証するスキル。

## 前提条件

- 開発サーバーが `http://localhost:3000` で起動していること
- chrome-devtools-mcp が MCP サーバーとして接続済みであること

## 実行手順

以下の検証を順番に実行し、各ステップでスクリーンショットを保存する。

### 0. 準備

1. chrome-devtools-mcp の `navigate` ツールで `http://localhost:3000` を開く
2. ページが表示されたことを確認するスクリーンショットを撮る

### 1. サイドバー・ナビゲーション検証

#### 1-1. ページ遷移

1. `http://localhost:3000` でホームページが表示されることを確認 → スクリーンショット保存
2. サイドバーの「JSON Formatter」リンクをクリック → `/json-formatter` に遷移することを確認 → スクリーンショット保存
3. サイドバーの「Base64」リンクをクリック → `/base64` に遷移することを確認 → スクリーンショット保存
4. サイドバーの「JWT Decoder」リンクをクリック → `/jwt-decoder` に遷移することを確認 → スクリーンショット保存

#### 1-2. アクティブ状態

各ページで、サイドバーの対応するリンクがアクティブスタイル（`bg-slate-700` クラス）になっていることを JavaScript で検証する。

#### 1-3. モバイル表示

1. ビューポートを `375x667`（モバイル幅）に変更
2. サイドバーが非表示になっていることを確認 → スクリーンショット保存
3. ハンバーガーメニューボタンをクリック
4. サイドバーがオーバーレイ表示されることを確認 → スクリーンショット保存
5. ビューポートを `1280x720` に戻す

### 2. JSON 整形ツール検証

`http://localhost:3000/json-formatter` に遷移する。

#### 2-1. 整形（正常系）

1. 入力テキストエリアに `{"name":"test","value":123}` を入力
2. 「整形」モードが選択されていることを確認
3. Ctrl+Enter を送信（または実行ボタンをクリック）
4. 出力エリアにインデント済みの JSON が表示されることを確認 → スクリーンショット保存

#### 2-2. 圧縮（正常系）

1. 入力テキストエリアに以下を入力:
   ```
   {
     "name": "test",
     "value": 123
   }
   ```
2. 「圧縮」モードに切り替え
3. 実行して出力が `{"name":"test","value":123}` になることを確認 → スクリーンショット保存

#### 2-3. バリデーションエラー（異常系）

1. 入力テキストエリアに `{"invalid": json}` を入力
2. 実行してエラーメッセージが表示されることを確認 → スクリーンショット保存

#### 2-4. コピーボタン

1. 正常な出力がある状態で、コピーボタンをクリック
2. ボタンアイコンがチェックマークに変化することを確認 → スクリーンショット保存

### 3. Base64 エンコード/デコード検証

`http://localhost:3000/base64` に遷移する。

#### 3-1. エンコード（正常系）

1. 入力テキストエリアに `Hello, World!` を入力
2. 自動判定で「エンコード」バッジが表示されることを確認
3. 出力エリアに `SGVsbG8sIFdvcmxkIQ==` が表示されることを確認 → スクリーンショット保存

#### 3-2. デコード（正常系）

1. 入力テキストエリアをクリアし `SGVsbG8sIFdvcmxkIQ==` を入力
2. 自動判定で「デコード」バッジが表示されることを確認
3. 出力エリアに `Hello, World!` が表示されることを確認 → スクリーンショット保存

#### 3-3. エラー（異常系）

1. 入力テキストエリアに `!!!invalid-base64!!!` を入力
2. エラー表示またはエンコード結果が表示されることを確認 → スクリーンショット保存

#### 3-4. リアルタイム変換

1. 入力テキストエリアに1文字ずつ入力
2. 出力が自動的に更新されることを確認（デバウンス 150ms 後）

### 4. JWT デコーダ検証

`http://localhost:3000/jwt-decoder` に遷移する。

テスト用 JWT トークン（期限切れ）:
```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyLCJleHAiOjE1MTYyMzkwMjJ9.4Adcj3UFYzPUVaVF43FmMab6RlaQD8A9V8wFzzht-KQ
```

#### 4-1. トークン解析（正常系）

1. 入力テキストエリアに上記テストトークンをペースト
2. Header / Payload / Signature の3セクションが表示されることを確認
3. Header に `alg: HS256`, `typ: JWT` が表示されていることを確認
4. Payload に `sub`, `name`, `iat`, `exp` フィールドが表示されていることを確認 → スクリーンショット保存

#### 4-2. 有効期限バー

1. テストトークンが期限切れであるため、期限切れ表示（赤）になっていることを確認 → スクリーンショット保存

#### 4-3. フィールドツールチップ

1. Payload セクション内の `sub` フィールドにホバー
2. ツールチップに説明が表示されることを確認 → スクリーンショット保存

#### 4-4. 不正トークン（異常系）

1. 入力テキストエリアに `not-a-jwt-token` を入力
2. エラーメッセージが表示されることを確認 → スクリーンショット保存

## スクリーンショット保存

- 保存先: `docs/evidence/`
- ファイル名規則: `{セクション番号}-{テスト名}.png`
  - 例: `1-1-home.png`, `2-1-json-format.png`, `4-2-jwt-expired.png`
- chrome-devtools-mcp の `screenshot` ツールを使用して撮影する

## 検証レポート

すべての検証完了後、`docs/evidence/REPORT.md` に以下のフォーマットでレポートを生成する:

```markdown
# Browser Verify 検証レポート

実行日時: YYYY-MM-DD HH:MM

## サマリー

| カテゴリ | 合格 | 不合格 | 合計 |
|---------|------|--------|------|
| サイドバー・ナビゲーション | X | X | X |
| JSON 整形ツール | X | X | X |
| Base64 エンコード/デコード | X | X | X |
| JWT デコーダ | X | X | X |
| **合計** | **X** | **X** | **X** |

## 詳細結果

### 1. サイドバー・ナビゲーション

| # | テスト項目 | 結果 | スクリーンショット | 備考 |
|---|----------|------|------------------|------|
| 1-1 | ページ遷移 | PASS/FAIL | [screenshot](1-1-home.png) | - |
| ... | ... | ... | ... | ... |

### 2. JSON 整形ツール

(同様のテーブル形式)

### 3. Base64 エンコード/デコード

(同様のテーブル形式)

### 4. JWT デコーダ

(同様のテーブル形式)

## 不合格項目の詳細

(不合格がある場合、原因と再現手順を記載)
```
